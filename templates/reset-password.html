{{define "reset-password-content"}}
{{if .Error}}
<div class="alert alert-error">
    {{.Error}}
</div>
{{end}}

{{if .Success}}
<div class="alert alert-success">
    {{.Success}}
</div>
{{end}}

<form id="resetForm" method="POST" action="/api/v1/auth/reset-password">
    <input type="hidden" name="token" value="{{.Token}}">

    <div class="form-group">
        <label for="new_password">Nueva contraseña</label>
        <input
            type="password"
            id="new_password"
            name="new_password"
            placeholder="Mínimo 8 caracteres"
            required
            autocomplete="new-password"
            minlength="8"
        >
        <small style="color: #718096; font-size: 12px; display: block; margin-top: 4px;">
            Debe contener mayúsculas, minúsculas, números y caracteres especiales
        </small>
    </div>

    <div class="form-group">
        <label for="confirm_password">Confirmar contraseña</label>
        <input
            type="password"
            id="confirm_password"
            name="confirm_password"
            placeholder="Repite tu nueva contraseña"
            required
            autocomplete="new-password"
        >
    </div>

    <div id="loading" class="loading">
        <div class="spinner"></div>
        <p style="margin-top: 12px; color: #718096;">Actualizando contraseña...</p>
    </div>

    <button type="submit" class="btn">
        Restablecer contraseña
    </button>
</form>

<div class="divider">
    <a href="/auth/login?app_id={{.AppID}}" style="color: {{.PrimaryColor}};">Volver al inicio de sesión</a>
</div>

<script>
    // Password validation
    const newPassword = document.getElementById('new_password');
    const confirmPassword = document.getElementById('confirm_password');

    confirmPassword.addEventListener('input', function() {
        if (newPassword.value !== confirmPassword.value) {
            confirmPassword.setCustomValidity('Las contraseñas no coinciden');
        } else {
            confirmPassword.setCustomValidity('');
        }
    });

    handleFormSubmit('resetForm', '/api/v1/auth/reset-password');
</script>
{{end}}
